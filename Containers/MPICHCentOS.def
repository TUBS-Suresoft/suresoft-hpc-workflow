BootStrap: docker
From: rockylinux:9
 
%files
    src src
    tests tests
    CMakeLists.txt CMakeLists.txt


%post
    yum update -y                           && \
    yum group install -y "Development Tools" && \
    yum install -y                             \
    mpich-devel                             && \
    cmake                                   && \
    source /etc/profile.d/modules.sh        && \
    module load mpi                         && \
    mkdir build && cd build && cmake .. && make


%apprun laplace
    source /etc/profile.d/modules.sh
    module load mpi
    mpirun -np 4 /build/bin/laplace